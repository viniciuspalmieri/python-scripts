import requests
import json
import geopandas as gpd
import matplotlib.pyplot as plt

# List of zip codes to highlight on the map
ziplist = [
    "34231",
    "34207",
    "34236",
    "33904",
    "34287",
    "34209",
    "34243",
    "33919",
    "34202",
    "34237",
    "34291",
    "33974",
    "33936",
    "33967",
    "33901",
    "34208",
    "33917",
    "33976",
    "33145",
    "34288",
    "33905",
    "33972",
    "33898",
    "34232",
    "34203",
    "33176",
    "34747",
    "33859",
    "33913",
    "33308",
    "34239",
    "33026",
    "33133",
    "32776",
    "33315",
    "32801",
    "33850",
    "33991",
    "34773",
    "33168",
    "33134",
    "34205",
    "34241",
    "33312",
    "32757",
    "32803",
    "32811",
    "32778",
    "33325",
    "33993",
    "33903",
    "33316",
    "33015",
    "33973",
    "33076",
    "34211",
    "34242",
    "33012",
    "33129",
    "34771",
    "34736",
    "33839",
    "33311",
    "33909",
    "33334",
    "33056",
    "33060",
    "34275",
    "33173",
    "33172",
    "33140",
    "33054",
    "33186",
    "33027",
    "33025",
    "33805",
    "33179",
    "33068",
    "33144",
    "34235",
    "32726",
    "32750",
    "32804",
    "33024",
    "32903",
    "34608",
    "34113",
    "33181",
    "33314",
    "34234",
    "32736",
    "32751",
    "32837",
    "33063",
    "33328",
    "34744",
    "33162",
    "33880",
    "33141",
    "33815",
    "32808",
    "33860",
    "33071",
    "33023",
    "33125",
    "32827",
    "34238",
    "34758",
    "33067",
    "34741",
    "32904",
    "33841",
    "33971",
    "34219",
    "33167",
    "32821",
    "33028",
    "33065",
    "34715",
    "34756",
    "33066",
    "34240",
    "32701",
    "34108",
    "33811",
    "33351",
    "34285",
    "33868",
    "33916",
    "33019",
    "34769",
    "33803",
    "34748",
    "32789",
    "33322",
    "32832",
    "33317",
    "32773",
    "33990",
    "33830",
    "34212",
    "34229",
    "33193",
    "33326",
    "34210",
    "33884",
    "33323",
    "32836",
    "32839",
    "32835",
    "33064",
    "34102",
    "33957",
    "33304",
    "33321",
    "34221",
    "34286",
    "33020",
    "32901",
    "32713",
    "34222",
    "33018",
    "33920",
    "33178",
    "33812",
    "33147",
    "34788",
    "33309",
    "33029",
    "34293",
    "33021",
    "34604",
    "33155",
    "33185",
    "33004",
    "33838",
    "34233",
    "33013",
    "33169",
    "34772",
    "33914",
    "32905",
    "32779",
    "34134",
    "32907",
    "33809",
    "32805",
    "33009",
    "32746",
    "33324",
    "34705",
    "34743",
    "33823",
    "34731",
    "33319",
    "32937",
    "32940",
    "34607",
    "33843",
    "33138",
    "33907",
    "33142",
    "33305",
    "33175",
    "34714",
    "33161",
    "33908",
    "32809",
    "32908",
    "33143",
    "33062",
    "32714",
    "33813",
    "32814",
    "33150",
    "33313",
    "34112",
    "33127",
    "32934",
    "33166",
    "33135",
    "32771",
    "33073",
    "33853",
    "33327",
    "33180",
    "33165",
    "34753",
    "34746",
    "32766",
    "34609",
    "32735",
    "33801",
    "32806",
    "34606",
    "32935",
    "34120",
    "33055",
    "32730",
]

# URL for the GeoJSON file of Florida zip codes
# URLs source https://github.com/OpenDataDE/State-zip-code-GeoJSON/tree/master
url = "https://github.com/OpenDataDE/State-zip-code-GeoJSON/raw/master/fl_florida_zip_codes_geo.min.json"
gj = requests.get(url).json()

# Load the GeoJSON into a GeoDataFrame
gdf = gpd.GeoDataFrame.from_features(gj["features"])

# Check the structure of the columns in the GeoDataFrame
print(gdf.columns)

# Add a new column to distinguish between highlighted and non-highlighted zip codes
gdf["highlight"] = gdf["ZCTA5CE10"].apply(
    lambda x: "green" if str(x) in ziplist else "white"
)

# Debug: Check if the 'highlight' column was created correctly
print(
    gdf[["ZCTA5CE10", "highlight"]].head()
)  # Display the first few rows with 'highlight' column

# Plot the map
fig, ax = plt.subplots(figsize=(12, 12))

# Plot the zip codes that are highlighted in green
gdf[gdf["highlight"] == "green"].plot(
    ax=ax, color="green", edgecolor="black", alpha=0.7
)

# Plot the zip codes that are not highlighted in white
gdf[gdf["highlight"] == "white"].plot(ax=ax, color="white", edgecolor="black", alpha=1)

# Add title to the map
ax.set_title("Florida Zip Codes with Selected Zips Highlighted", fontsize=16)

# Display the plot
plt.show()
